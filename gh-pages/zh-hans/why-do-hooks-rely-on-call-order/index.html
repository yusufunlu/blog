<!DOCTYPE html><html lang="zh-hans"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/2.4ac699a3d6a5be115d81.css">@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:url(/static/merriweather-400-l-8796b7875d52e9cb9b280211e8d3f82d.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:url(/static/montserrat-900-l-5751237264c0468be0d48ad1cea75b90.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}body{--pink:#ffa7c4;background-color:var(--bg)}body.light{--bg:#fff;--header:var(--pink);--textNormal:#222;--textTitle:#222;--textLink:#d23669;--hr:rgba(0,0,0,0.2);--inlineCode-bg:rgba(255,229,100,0.2);--inlineCode-text:#1a1a1a}body.dark{-webkit-font-smoothing:antialiased;--bg:#282c35;--header:#fff;--textNormal:hsla(0,0%,100%,0.88);--textTitle:#fff;--textLink:var(--pink);--hr:hsla(0,0%,100%,0.2);--inlineCode-bg:#373c49;--inlineCode-text:#e6e6e6}body:lang(ar) article,body:lang(fa) article{direction:rtl}body:lang(ar) .language-text,body:lang(ar) article .translations,body:lang(ar) article pre,body:lang(fa) .language-text,body:lang(fa) article .translations,body:lang(fa) article pre{direction:ltr}body:lang(ar) .language-text,body:lang(fa) .language-text{display:inline-block}body:lang(ar) blockquote,body:lang(fa) blockquote{border-left:unset;border-right:.32813rem solid rgba(0,0,0,.9);padding-right:1.42188rem;padding-left:unset;margin-left:.75rem;margin-right:-1.75rem}body:lang(fa) article,body:lang(fa) header>h1{font-family:Vazir}body:lang(ar) article,body:lang(ar) header>h1{font-family:Cairo,sans-serif}body:lang(ko) article,body:lang(ko) header{word-break:keep-all}code[class*=language-],pre[class*=language-]{color:#fff;background:none;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;-webkit-font-feature-settings:normal;font-feature-settings:normal;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;margin-bottom:0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{overflow:auto;padding:1.3125rem}pre[class*=language-]::selection{background:#27292a}pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:hsla(0,0%,100%,.15)}:not(pre)>code[class*=language-]{border-radius:.3em;background:var(--inlineCode-bg);color:var(--inlineCode-text);padding:.15em .2em .05em;white-space:normal}.token.attr-name{color:#addb67;font-style:italic}.token.comment{color:#809393}.token.string,.token.url{color:#addb67}.token.variable{color:#d6deeb}.token.number{color:#f78c6c}.token.builtin,.token.char,.token.constant,.token.function{color:#82aaff}.token.punctuation{color:#c792ea}.token.doctype,.token.selector{color:#c792ea;font-style:"italic"}.token.class-name{color:#ffcb8b}.token.keyword,.token.operator,.token.tag{color:#ffa7c4}.token.boolean{color:#ff5874}.token.property{color:#80cbc4}.token.namespace{color:#b2ccd6}pre[data-line]{padding:1em 0 1em 3em;position:relative}.gatsby-highlight-code-line{background-color:#022a4b;display:block;padding-right:1em;padding-left:1.25em;border-left:.25em solid #ffa7c4}.gatsby-highlight,.gatsby-highlight-code-line{margin-right:-1.3125rem;margin-left:-1.3125rem}.gatsby-highlight{margin-bottom:1.75rem;border-radius:10px;background:#011627;-webkit-overflow-scrolling:touch;overflow:auto}@media (max-width:672px){.gatsby-highlight{border-radius:0}}.gatsby-highlight pre[class*=language-]{float:left;min-width:100%}.react-toggle{touch-action:pan-x;display:inline-block;position:relative;cursor:pointer;background-color:transparent;border:0;padding:0;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-tap-highlight-color:transparent}.react-toggle-screenreader-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.react-toggle-track{width:50px;height:24px;padding:0;border-radius:30px;background-color:#0f1114;transition:all .2s ease}.react-toggle-track-check{position:absolute;width:17px;height:17px;left:5px;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0;opacity:0;transition:opacity .25s ease}.react-toggle--checked .react-toggle-track-check,.react-toggle-track-x{opacity:1;transition:opacity .25s ease}.react-toggle-track-x{position:absolute;width:17px;height:17px;right:5px;top:0;bottom:0;margin-top:auto;margin-bottom:auto;line-height:0}.react-toggle--checked .react-toggle-track-x{opacity:0}.react-toggle-thumb{position:absolute;top:1px;left:1px;width:22px;height:22px;border-radius:50%;background-color:#fafafa;box-sizing:border-box;transition:all .5s cubic-bezier(.23,1,.32,1) 0ms;-webkit-transform:translateX(0);transform:translateX(0)}.react-toggle--checked .react-toggle-thumb{-webkit-transform:translateX(26px);transform:translateX(26px);border-color:#19ab27}.react-toggle--focus .react-toggle-thumb{box-shadow:0 0 2px 3px #ffa7c4}.react-toggle:active .react-toggle-thumb{box-shadow:0 0 5px 5px #ffa7c4}</style><style data-href="/component---src-templates-blog-post-js.f3aea2f29a9b96501823.css">@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:url(/static/merriweather-400-i-l-9a3ea56a5f449980432ace5972181ef6.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:url(/static/merriweather-700-l-e24e02bb044cb07539a3a6bd12348d14.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:url(/static/merriweather-700-i-l-ad085ede31afcc5585ff34869b1cd029.woff2) format("woff2");unicode-range:U+00??,U+0131,U+0152-0153,U+02bb-02bc,U+02c6,U+02da,U+02dc,U+2000-206f,U+2074,U+20ac,U+2122,U+2191,U+2193,U+2212,U+2215,U+feff,U+fffd}.formkit-form *{box-sizing:border-box}.formkit-form legend{border:none;font-size:inherit;margin-bottom:10px;padding:0;position:relative;display:table}.formkit-form fieldset{border:0;padding:.01em 0 0;margin:0;min-width:0}.formkit-form body:not(:-moz-handler-blocked) fieldset{display:table-cell}.formkit-form p{color:inherit;font-size:inherit;font-weight:inherit}.formkit-form[data-format="slide in"],.formkit-form[data-format=modal]{display:none}.formkit-form .formkit-checkboxes,.formkit-form .formkit-input,.formkit-form .formkit-select{width:100%}.formkit-form .formkit-button,.formkit-form .formkit-submit{border:0;border-radius:5px;color:#fff;cursor:pointer;display:inline-block;text-align:center;font-size:15px;font-weight:500;margin-bottom:15px;overflow:hidden;padding:0;position:relative;vertical-align:middle}.formkit-form .formkit-button:focus,.formkit-form .formkit-button:hover,.formkit-form .formkit-submit:focus,.formkit-form .formkit-submit:hover{outline:none}.formkit-form .formkit-button:focus>span,.formkit-form .formkit-button:hover>span,.formkit-form .formkit-submit:focus>span,.formkit-form .formkit-submit:hover>span{background-color:#dc658d}.formkit-form .formkit-button>span,.formkit-form .formkit-submit>span{display:block;transition:all .3s ease-in-out;padding:12px 24px}.formkit-form .formkit-input{background:#fff;font-size:15px;padding:12px;border:1px solid #e3e3e3;flex:1 0 auto;line-height:1.4;margin:0;transition:border-color .3s ease-out}.formkit-form .formkit-input:focus{outline:none;border-color:#1677be;transition:border-color .3s ease}.formkit-form .formkit-input::-webkit-input-placeholder{color:#848585}.formkit-form .formkit-input:-ms-input-placeholder{color:#848585}.formkit-form .formkit-input::-ms-input-placeholder{color:#848585}.formkit-form .formkit-input::placeholder{color:#848585}.formkit-form [data-group=dropdown]{position:relative;display:inline-block;width:100%}.formkit-form [data-group=dropdown]:before{content:"";top:calc(50% - 2.5px);right:10px;position:absolute;pointer-events:none;border-color:#4f4f4f transparent transparent;border-style:solid;border-width:6px 6px 0;height:0;width:0;z-index:999}.formkit-form [data-group=dropdown] select{height:auto;width:100%;cursor:pointer;color:#333;line-height:1.4;margin-bottom:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;font-size:15px;padding:12px 25px 12px 12px;border:1px solid #e3e3e3;background:#fff}.formkit-form [data-group=dropdown] select:focus{outline:none}.formkit-form [data-group=checkboxes]{text-align:left;margin:0}.formkit-form [data-group=checkboxes] [data-group=checkbox]{margin-bottom:10px}.formkit-form [data-group=checkboxes] [data-group=checkbox] *{cursor:pointer}.formkit-form [data-group=checkboxes] [data-group=checkbox]:last-of-type{margin-bottom:0}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]{display:none}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]+label:after{content:none}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]:checked+label:after{border-color:#fff;content:""}.formkit-form [data-group=checkboxes] [data-group=checkbox] input[type=checkbox]:checked+label:before{background:#10bf7a;border-color:#10bf7a}.formkit-form [data-group=checkboxes] [data-group=checkbox] label{position:relative;display:inline-block;padding-left:28px}.formkit-form [data-group=checkboxes] [data-group=checkbox] label:after,.formkit-form [data-group=checkboxes] [data-group=checkbox] label:before{position:absolute;content:"";display:inline-block}.formkit-form [data-group=checkboxes] [data-group=checkbox] label:before{height:16px;width:16px;border:1px solid #e3e3e3;background:#fff;left:0;top:3px}.formkit-form [data-group=checkboxes] [data-group=checkbox] label:after{height:4px;width:8px;border-left:2px solid #4d4d4d;border-bottom:2px solid #4d4d4d;-webkit-transform:rotate(-45deg);transform:rotate(-45deg);left:4px;top:8px}.formkit-form .formkit-alert{background:#f9fafb;border:1px solid #e3e3e3;border-radius:5px;flex:1 0 auto;list-style:none;margin:25px auto;padding:12px;text-align:center;width:100%}.formkit-form .formkit-alert:empty{display:none}.formkit-form .formkit-alert-success{background:#d3fbeb;border-color:#10bf7a;color:#0c905c}.formkit-form .formkit-alert-error{background:#fde8e2;border-color:#f2643b;color:#ea4110}.formkit-form .formkit-spinner{display:flex;height:0;width:0;margin:0 auto;position:absolute;top:0;left:0;right:0;overflow:hidden;text-align:center;transition:all .3s ease-in-out}.formkit-form .formkit-spinner>div{margin:auto;width:12px;height:12px;background-color:#fff;opacity:.3;border-radius:100%;display:inline-block;-webkit-animation:formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd- 1.4s ease-in-out infinite both;animation:formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd- 1.4s ease-in-out infinite both}.formkit-form .formkit-spinner>div:first-child{-webkit-animation-delay:-.32s;animation-delay:-.32s}.formkit-form .formkit-spinner>div:nth-child(2){-webkit-animation-delay:-.16s;animation-delay:-.16s}.formkit-form .formkit-submit[data-active] .formkit-spinner{opacity:1;height:100%;width:50px}.formkit-form .formkit-submit[data-active] .formkit-spinner~span{opacity:0}@-webkit-keyframes formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd-{0%,80%,to{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}@keyframes formkit-bouncedelay-formkit-form-data-uid-4a352cb1fd-{0%,80%,to{-webkit-transform:scale(0);transform:scale(0)}40%{-webkit-transform:scale(1);transform:scale(1)}}.formkit-form{box-shadow:0 2px 15px 0 rgba(210,214,220,.5);max-width:700px;overflow:hidden}.formkit-form [data-style=full]{width:100%;display:block}.formkit-form .formkit-header{margin-top:0;margin-bottom:20px;font-family:inherit}.formkit-form .formkit-subheader{margin:15px 0}.formkit-form .formkit-column{background-size:cover;background-repeat:no-repeat;background-position:50%;padding:20px}.formkit-form .formkit-column:nth-child(2){border-top:1px solid #e9ecef}.formkit-form .formkit-field{margin:0 0 15px}.formkit-form .formkit-input,.formkit-form .formkit-submit{width:100%}.formkit-form .formkit-guarantee{font-size:13px;margin:0 0 15px}.formkit-form .formkit-guarantee>p{margin:0}.formkit-form .formkit-powered-by{color:#7d7d7d;display:block;font-size:12px;margin-bottom:0;text-align:center}.formkit-form .formkit-powered-by[data-active=false]{opacity:.5}.formkit-form[min-width~="600"] [data-style=full],.formkit-form[min-width~="700"] [data-style=full],.formkit-form[min-width~="800"] [data-style=full]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}.formkit-form[min-width~="600"] .formkit-submit,.formkit-form[min-width~="700"] .formkit-submit,.formkit-form[min-width~="800"] .formkit-submit{width:auto}.formkit-form[min-width~="600"] .formkit-column,.formkit-form[min-width~="700"] .formkit-column,.formkit-form[min-width~="800"] .formkit-column{padding:40px}.formkit-form[min-width~="600"] .formkit-column:nth-child(2),.formkit-form[min-width~="700"] .formkit-column:nth-child(2),.formkit-form[min-width~="800"] .formkit-column:nth-child(2){border-top:none}</style><meta name="generator" content="Gatsby 2.0.91"/><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="alternate" type="application/rss+xml" title="Dan Abramov&#x27;s Overreacted Blog RSS Feed" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png"/><link rel="manifest" href="/manifest.webmanifest"/><title data-react-helmet="true">ä¸ºä»€ä¹ˆé¡ºåºè°ƒç”¨å¯¹ React Hooks å¾ˆé‡è¦ï¼Ÿ â€” Overreacted</title><meta data-react-helmet="true" name="theme-color" content="#282c35"/><meta data-react-helmet="true" name="description" content="å­¦ä¹  mixinsï¼Œrender propsï¼Œ HOCsï¼Œå’Œ class çš„è¯¾ç¨‹ã€‚"/><meta data-react-helmet="true" property="og:url" content="https://overreacted.io/zh-hans/why-do-hooks-rely-on-call-order/"/><meta data-react-helmet="true" property="og:title" content="ä¸ºä»€ä¹ˆé¡ºåºè°ƒç”¨å¯¹ React Hooks å¾ˆé‡è¦ï¼Ÿ"/><meta data-react-helmet="true" property="og:description" content="å­¦ä¹  mixinsï¼Œrender propsï¼Œ HOCsï¼Œå’Œ class çš„è¯¾ç¨‹ã€‚"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="@dan_abramov"/><meta data-react-helmet="true" name="twitter:title" content="ä¸ºä»€ä¹ˆé¡ºåºè°ƒç”¨å¯¹ React Hooks å¾ˆé‡è¦ï¼Ÿ"/><meta data-react-helmet="true" name="twitter:description" content="å­¦ä¹  mixinsï¼Œrender propsï¼Œ HOCsï¼Œå’Œ class çš„è¯¾ç¨‹ã€‚"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.75 'Merriweather','Georgia',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.9);font-family:'Merriweather','Georgia',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:Montserrat,sans-serif;font-weight:900;text-rendering:optimizeLegibility;font-size:2.5rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.73286rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1.4427rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;letter-spacing:0.140625em;text-transform:uppercase;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.83255rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;color:inherit;font-family:'Merriweather','Georgia',serif;font-weight:900;text-rendering:optimizeLegibility;font-size:0.75966rem;line-height:1.1;font-style:italic;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}ul{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;list-style:disc;}ol{margin-left:1.75rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:0.85rem;line-height:1.75rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1rem;line-height:1.75rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}blockquote{margin-left:-1.75rem;margin-right:1.75rem;margin-top:0;padding-bottom:0;padding-left:1.42188rem;padding-right:0;padding-top:0;margin-bottom:1.75rem;font-size:1.20112rem;line-height:1.75rem;color:inherit;font-style:italic;border-left:0.32813rem solid hsla(0,0%,0%,0.9);border-left-color:inherit;opacity:0.8;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.75rem - 1px);background:var(--hr);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.75rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.75rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}li > ul{margin-left:1.75rem;margin-bottom:calc(1.75rem / 2);margin-top:calc(1.75rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.75rem / 2);}code{font-size:0.85rem;line-height:1.75rem;}kbd{font-size:0.85rem;line-height:1.75rem;}samp{font-size:0.85rem;line-height:1.75rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.16667rem;padding-right:1.16667rem;padding-top:0.875rem;padding-bottom:calc(0.875rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}blockquote > :last-child{margin-bottom:0;}blockquote cite{font-size:1rem;line-height:1.75rem;color:hsla(0,0%,0%,0.9);font-weight:400;}blockquote cite:before{content:"â€” ";}ul,ol{margin-left:0;}@media only screen and (max-width:480px){ul,ol{margin-left:1.75rem;}blockquote{margin-left:-1.3125rem;margin-right:0;padding-left:0.98438rem;}}h1,h2,h3,h4,h5,h6{margin-top:3.5rem;}a{box-shadow:0 1px 0 0 currentColor;color:var(--textLink);text-decoration:none;}a:hover,a:active{box-shadow:none;}mark,ins{background:#007acc;color:white;padding:0.10938rem 0.21875rem;text-decoration:none;}a.gatsby-resp-image-link{box-shadow:none;}a.anchor{box-shadow:none;}a.anchor svg[aria-hidden="true"]{stroke:var(--textLink);}p code{font-size:1rem;}h1 code, h2 code, h3 code, h4 code, h5 code, h6 code{font-size:inherit;}li code{font-size:1rem;}blockquote.translation{font-size:1em;}</style><link as="script" rel="preload" href="/component---src-templates-blog-post-js-5ff9d93420b5b2cefece.js"/><link as="script" rel="preload" href="/app-83825dcbe188439d174e.js"/><link as="script" rel="preload" href="/0-b197e8c6c7ff26484233.js"/><link as="script" rel="preload" href="/2-31a6021f1637c5720eda.js"/><link as="script" rel="preload" href="/1-1b550cd61a5e170131aa.js"/><link as="script" rel="preload" href="/webpack-runtime-dea655677e505366ecd7.js"/><link as="fetch" rel="preload" href="/static/d/225/path---zh-hans-why-do-hooks-rely-on-call-order-e-3-e-fa3-Z0j3dSZmZX3xUyUNXfYKoEZsr8.json" crossorigin="use-credentials"/></head><body class="light"><script>
              (function() {
                window.__onThemeChange = function() {};
                function setTheme(newTheme) {
                  window.__theme = newTheme;
                  preferredTheme = newTheme;
                  document.body.className = newTheme;
                  window.__onThemeChange(newTheme);
                }

                var preferredTheme;
                try {
                  preferredTheme = localStorage.getItem('theme');
                } catch (err) { }

                window.__setPreferredTheme = function(newTheme) {
                  setTheme(newTheme);
                  try {
                    localStorage.setItem('theme', newTheme);
                  } catch (err) {}
                }

                var darkQuery = window.matchMedia('(prefers-color-scheme: dark)');
                darkQuery.addListener(function(e) {
                  window.__setPreferredTheme(e.matches ? 'dark' : 'light')
                });

                setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'));
              })();
            </script><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div style="color:var(--textNormal);background:var(--bg);transition:color 0.2s ease-out, background 0.2s ease-out;min-height:100vh"><div style="margin-left:auto;margin-right:auto;max-width:42rem;padding:2.625rem 1.3125rem"><header style="display:flex;justify-content:space-between;align-items:center;margin-bottom:2.625rem"><h3 style="font-family:Montserrat, sans-serif;margin-top:0;margin-bottom:0;height:42px;line-height:2.625rem"><a style="box-shadow:none;text-decoration:none;color:rgb(255, 167, 196)" href="/">Overreacted</a></h3><div style="height:24px"></div></header><main><article><header><h1 style="color:var(--textTitle)">ä¸ºä»€ä¹ˆé¡ºåºè°ƒç”¨å¯¹ React Hooks å¾ˆé‡è¦ï¼Ÿ</h1><p style="font-size:0.83255rem;line-height:1.75rem;display:block;margin-bottom:1.75rem;margin-top:-1.4rem">2018 M12 13<!-- --> â€¢ â˜•ï¸â˜•ï¸ 11 min read</p><div class="translations"><p style="font-size:0.9em;border:1px solid var(--hr);border-radius:0.75em;padding:0.75em;background:var(--inlineCode-bg);word-break:keep-all;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"><span><span>Translated by readers into: </span><a href="/es/why-do-hooks-rely-on-call-order/">EspaÃ±ol</a> â€¢ <a href="/fr/why-do-hooks-rely-on-call-order/">FranÃ§ais</a> â€¢ <b>ç®€ä½“ä¸­æ–‡</b></span><br/><br/><a href="/why-do-hooks-rely-on-call-order/">Read the original</a> â€¢ <a href="https://github.com/gaearon/overreacted.io/edit/master/src/pages/why-do-hooks-rely-on-call-order/index.zh-hans.md" target="_blank" rel="noopener noreferrer">Improve this translation</a> â€¢ <a href="/zh-hans">View all translated posts</a> </p></div></header><div><p>æœ€åˆä½ å¯èƒ½ä¼šä¸å–œæ¬¢ Hooksï¼š</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/2/14/168ea037c69fce4e?w=616&#x26;h=110&#x26;f=png&#x26;s=33543" alt="Negative HN comment"></p>
<p>å®ƒä»¬å°±åƒä¸€æ®µéŸ³ä¹ï¼Œåªæœ‰ç»è¿‡å‡ æ¬¡ç”¨å¿ƒè†å¬æ‰ä¼šæ…¢æ…¢çˆ±ä¸Šï¼š</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/2/14/168ea249f3f7b83e?w=617&#x26;h=135&#x26;f=png&#x26;s=44605" alt="Positive HN comment from the same person four days later"></p>
<p>å½“ä½ é˜…è¯»æ–‡æ¡£æ—¶ï¼Œä¸è¦é”™è¿‡å…³äº<a href="https://reactjs.org/docs/hooks-custom.html" target="_blank" rel="nofollow noopener noreferrer">æœ€é‡è¦çš„éƒ¨åˆ†</a>â€”â€”åˆ›é€ å±äºä½ è‡ªå·±çš„ Hooksï¼å¤ªå¤šçš„äººçº ç»“äºåå¯¹æˆ‘ä»¬çš„è§‚ç‚¹ï¼ˆclass å­¦ä¹ æˆæœ¬é«˜ç­‰ï¼‰ä»¥è‡³äºé”™è¿‡äº† Hooks æ›´é‡è¦çš„ä¸€é¢ï¼ŒHooks åƒ <code class="language-text">functional mixins</code>ï¼Œå¯ä»¥è®©ä½ åˆ›é€ å’Œæ­å»ºå±äºè‡ªå·±çš„ Hookã€‚</p>
<p>Hooks <a href="https://reactjs.org/docs/hooks-faq.html#what-is-the-prior-art-for-hooks" target="_blank" rel="nofollow noopener noreferrer">å—å¯å‘äºä¸€äº›ç°æœ‰æŠ€æœ¯</a>ï¼Œä½†åœ¨ Sebastian å’Œå›¢é˜Ÿåˆ†äº«ä»–çš„æƒ³æ³•ä¹‹åï¼Œæˆ‘æ‰çŸ¥é“è¿™äº›ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº› API å’Œç°åœ¨åœ¨ç”¨çš„ä¹‹é—´çš„å…³è”å¾ˆå®¹æ˜“è¢«å¿½ç•¥ï¼Œé€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å¸Œæœ›å¯ä»¥å¸®åŠ©æ›´å¤šçš„äººç†è§£ Hooks ææ¡ˆä¸­äº‰è®®è¾ƒå¤§çš„ç‚¹ã€‚</p>
<p><strong>æ¥ä¸‹æ¥çš„éƒ¨åˆ†éœ€è¦ä½ çŸ¥é“ Hook API çš„ <code class="language-text">useState</code> å’Œå¦‚ä½•å†™è‡ªå®šä¹‰ Hookã€‚å¦‚æœä½ è¿˜ä¸æ‡‚ï¼Œå¯ä»¥çœ‹çœ‹æ—©å…ˆçš„é“¾æ¥ã€‚</strong></p>
<p>(å…è´£è¯´æ˜ï¼šæ–‡ç« çš„è§‚ç‚¹ä»…ä»£è¡¨ä¸ªäººæƒ³æ³•ï¼Œä¸ React å›¢é˜Ÿæ— å…³ã€‚è¯é¢˜å¤§ä¸”å¤æ‚ï¼Œå…¶ä¸­å¯èƒ½æœ‰é”™è¯¯çš„è§‚ç‚¹ã€‚)</p>
<hr>
<p>ä¸€å¼€å§‹å½“ä½ å­¦ä¹ æ—¶ä½ å¯èƒ½ä¼šéœ‡æƒŠï¼ŒHooks é‡æ¸²æŸ“æ—¶æ˜¯ä¾èµ–äºå›ºå®šé¡ºåºè°ƒç”¨çš„ï¼Œè¿™é‡Œæœ‰<a href="https://reactjs.org/docs/hooks-rules.html" target="_blank" rel="nofollow noopener noreferrer">è¯´æ˜</a>ã€‚</p>
<p>è¿™ä¸ªå†³å®šæ˜¾ç„¶æ˜¯æœ‰äº‰è®®çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¼šæœ‰äºº<a href="https://www.reddit.com/r/reactjs/comments/9xs2r6/sebmarkbages_response_to_hooks_rfc_feedback/e9wh4um/" target="_blank" rel="nofollow noopener noreferrer">åå¯¹æˆ‘ä»¬çš„ææ¡ˆ</a>ã€‚æˆ‘ä»¬ä¼šåœ¨æ°å½“çš„æ—¶æœºå‘å¸ƒè¿™ä¸ªææ¡ˆï¼Œå½“æˆ‘ä»¬è§‰å¾—æ–‡æ¡£å’Œè®²åº§å¯ä»¥è¶³å¤Ÿå¥½çš„æç»˜å®ƒæ—¶ã€‚</p>
<p>å¦‚æœä½ åœ¨å…³æ³¨ Hooks API çš„æŸäº›ç‚¹ï¼Œæˆ‘å»ºè®®ä½ é˜…è¯»ä¸‹ Sebastian å¯¹ 1000+ è¯„è®º RFC çš„<a href="https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884" target="_blank" rel="nofollow noopener noreferrer">å…¨éƒ¨å›å¤</a>ï¼Œ<strong>è¶³å¤Ÿé€æ¾ˆä½†å†…å®¹éå¸¸å¤šï¼Œæˆ‘å¯èƒ½ä¼šå°†è¯„è®ºä¸­çš„æ¯ä¸€æ®µéƒ½å˜æˆè‡ªå·±çš„åšå®¢æ–‡ç« ã€‚(äº‹å®ä¸Šï¼Œæˆ‘å·²ç»<a href="/zh-hans/how-does-setstate-know-what-to-do/">åšè¿‡</a>ä¸€æ¬¡ï¼)</strong></p>
<p>æˆ‘ä»Šå¤©è¦å…³æ³¨ä¸€ä¸ªå…·ä½“éƒ¨åˆ†ã€‚ä½ å¯èƒ½è¿˜è®°å¾—ï¼Œæ¯ä¸ª Hook å¯ä»¥åœ¨ç»„ä»¶é‡Œè¢«å¤šæ¬¡ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code class="language-text">useState</code> å£°æ˜<a href="https://reactjs.org/docs/hooks-state.html#tip-using-multiple-state-variables" target="_blank" rel="nofollow noopener noreferrer">å¤šä¸ªstate</a>ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">// State å˜é‡ 1</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>surname<span class="token punctuation">,</span> setSurname<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment">// State å˜é‡ 2</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> setWidth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// State å˜é‡ 3</span></span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleResize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setWidth</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handleResize<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleNameChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">handleSurnameChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setSurname</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleNameChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>surname<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSurnameChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Hello, </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token plain-text"> </span><span class="token punctuation">{</span>surname<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Window width: </span><span class="token punctuation">{</span>width<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>æ³¨æ„æˆ‘ä»¬ç”¨æ•°ç»„è§£æ„è¯­æ³•æ¥å‘½å <code class="language-text">useState()</code> è¿”å›çš„ state å˜é‡ï¼Œä½†è¿™äº›å˜é‡ä¸ä¼šè¿æ¥åˆ° React ç»„ä»¶ä¸Šã€‚ç›¸åï¼Œè¿™ä¸ªä¾‹å­ä¸­ï¼Œ<strong>React å°† <code class="language-text">name</code> è§†ä¸ºã€Œç¬¬ä¸€ä¸ª state å˜é‡ã€ï¼Œ<code class="language-text">surname</code> è§†ä¸ºã€Œç¬¬äºŒä¸ª state å˜é‡ã€ï¼Œä»¥æ­¤ç±»æ¨</strong>ã€‚å®ƒä»¬åœ¨é‡æ–°æ¸²æŸ“æ—¶ç”¨ <em>é¡ºåºè°ƒç”¨</em> æ¥ä¿è¯è¢«æ­£ç¡®è¯†åˆ«ã€‚<a href="https://juejin.im/post/5bfa929551882524cb6f413b" target="_blank" rel="nofollow noopener noreferrer">è¿™ç¯‡æ–‡ç« </a>è¯¦ç»†çš„è§£é‡Šäº†åŸå› ã€‚</p>
<p>è¡¨é¢ä¸Šçœ‹ï¼Œä¾èµ–äºé¡ºåºè°ƒç”¨åªæ˜¯<em>æ„Ÿè§‰æœ‰é—®é¢˜</em>ï¼Œç›´è§‰æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„ä¿¡å·ï¼Œä½†å®ƒæœ‰æ—¶ä¼šè¯¯å¯¼æˆ‘ä»¬ â€”â€” ç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬è¿˜æ²¡æœ‰å®Œå…¨æ¶ˆåŒ–å›°æƒ‘çš„é—®é¢˜ã€‚<strong>è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä¼šæåˆ°å‡ ä¸ªç»å¸¸æœ‰äººæå‡ºä¿®æ”¹ Hooks çš„æ–¹æ¡ˆï¼ŒåŠå®ƒä»¬å­˜åœ¨çš„é—®é¢˜</strong>ã€‚</p>
<hr>
<p>è¿™ç¯‡æ–‡ç« ä¸ä¼šè¯¦å°½æ— é—ï¼Œå¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»¬å·²ç»çœ‹è¿‡åå‡ ç§è‡³æ•°ç™¾ç§ä¸åŒçš„æ›¿ä»£æ–¹æ¡ˆï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨<a href="https://github.com/reactjs/react-future" target="_blank" rel="nofollow noopener noreferrer">è€ƒè™‘</a>æ›¿æ¢ç»„ä»¶ APIã€‚</p>
<p>è¯¸å¦‚æ­¤ç±»çš„åšå®¢å¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºå³ä½¿ä½ æ¶‰åŠäº†ä¸€ç™¾ç§æ›¿ä»£æ–¹æ¡ˆï¼Œä¹Ÿæœ‰äººå¼ºè¡Œæå‡ºä¸€ä¸ªæ¥ï¼šã€Œå“ˆå“ˆï¼Œä½ æ²¡æœ‰æƒ³åˆ°<em>è¿™ä¸ª</em>ï¼ã€</p>
<p>åœ¨å®è·µä¸­ï¼Œä¸åŒæ›¿ä»£æ–¹æ¡ˆæåˆ°çš„é—®é¢˜ä¼šæœ‰å¾ˆå¤šé‡å¤ï¼Œæˆ‘ä¸ä¼šåˆ—ä¸¾<em>æ‰€æœ‰</em>å»ºè®®çš„ APIï¼ˆè¿™éœ€è¦èŠ±è´¹æ•°æœˆæ—¶é—´ï¼‰ï¼Œè€Œæ˜¯é€šè¿‡å‡ ä¸ªå…·ä½“ç¤ºä¾‹å±•ç¤ºæœ€å¸¸è§çš„é—®é¢˜ï¼Œæ›´å¤šçš„é—®é¢˜å°±è€ƒéªŒè¯»è€…ä¸¾ä¸€åä¸‰çš„èƒ½åŠ›äº†ã€‚ğŸ§</p>
<p><em>è¿™ä¸æ˜¯è¯´ Hooks å°±æ˜¯å®Œç¾çš„</em>ï¼Œä½†æ˜¯ä¸€æ—¦ä½ äº†è§£å…¶ä»–è§£å†³æ–¹æ¡ˆçš„ç¼ºé™·ï¼Œä½ å¯èƒ½ä¼šå‘ç° Hooks çš„è®¾è®¡æ˜¯æœ‰é“ç†çš„ã€‚</p>
<hr>
<h3 id="ç¼ºé™·-1ï¼šæ— æ³•æå–-custom-hook"><a href="#%E7%BC%BA%E9%99%B7-1%EF%BC%9A%E6%97%A0%E6%B3%95%E6%8F%90%E5%8F%96-custom-hook" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #1ï¼šæ— æ³•æå– custom hook</h3>
<p>å‡ºä¹æ„æ–™çš„æ˜¯ï¼Œå¤§å¤šæ•°æ›¿ä»£æ–¹æ¡ˆå®Œå…¨æ²¡æœ‰æåˆ° <a href="https://reactjs.org/docs/hooks-custom.html" target="_blank" rel="nofollow noopener noreferrer">custom hooks</a>ã€‚å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ã€Œmotivationã€æ–‡æ¡£ä¸­æ²¡æœ‰è¶³å¤Ÿå¼ºè°ƒ custom hooksï¼Œä¸è¿‡åœ¨å¼„æ‡‚ Hooks åŸºæœ¬åŸç†ä¹‹å‰ï¼Œè¿™æ˜¯å¾ˆéš¾åšåˆ°çš„ã€‚å°±åƒé¸¡å’Œè›‹é—®é¢˜ï¼Œä½†å¾ˆå¤§ç¨‹åº¦ä¸Š custom hooks æ˜¯ææ¡ˆçš„é‡ç‚¹ã€‚</p>
<p>ä¾‹å¦‚ï¼šæœ‰ä¸ªæ›¿ä»£æ–¹æ¡ˆæ˜¯é™åˆ¶ä¸€ä¸ªç»„ä»¶è°ƒç”¨å¤šæ¬¡ <code class="language-text">useState()</code>ï¼Œä½ å¯ä»¥æŠŠ state æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œï¼Œè¿™æ ·è¿˜å¯ä»¥å…¼å®¹ class ä¸æ˜¯æ›´å¥½å—ï¼Ÿ</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'Mary'</span><span class="token punctuation">,</span>
    surname<span class="token punctuation">:</span> <span class="token string">'Poppins'</span><span class="token punctuation">,</span>
    width<span class="token punctuation">:</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>è¦æ¸…æ¥šï¼ŒHooks æ˜¯å…è®¸è¿™ç§é£æ ¼å†™çš„ï¼Œä½ ä¸å¿…å°† state æ‹†åˆ†æˆä¸€å † state å˜é‡ï¼ˆè¯·å‚é˜…å‚è§é—®é¢˜è§£ç­”ä¸­çš„<a href="https://reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables" target="_blank" rel="nofollow noopener noreferrer">å»ºè®®</a>ï¼‰ã€‚</p>
<p>ä½†æ”¯æŒå¤šæ¬¡è°ƒç”¨ <code class="language-text">useState()</code> çš„å…³é”®åœ¨äºï¼Œä½ å¯ä»¥ä»ç»„ä»¶ä¸­æå–å‡ºéƒ¨åˆ†æœ‰çŠ¶æ€é€»è¾‘ï¼ˆstate + effectï¼‰åˆ° custom hooks ä¸­ï¼ŒåŒæ—¶å¯ä»¥å•ç‹¬ä½¿ç”¨æœ¬åœ° state å’Œ effectsï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åœ¨ç»„ä»¶å†…ç›´æ¥å®šä¹‰ä¸€äº› state å˜é‡</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Mary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>surname<span class="token punctuation">,</span> setSurname<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'Poppins'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="gatsby-highlight-code-line">  <span class="token comment">// æˆ‘ä»¬å°†éƒ¨åˆ† state å’Œ effects ç§»è‡³ custom hook</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token function">useWindowWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useWindowWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// åœ¨ custom hook å†…å®šä¹‰ä¸€äº› state å˜é‡</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> setWidth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> width<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å¦‚æœä½ åªå…è®¸æ¯ä¸ªç»„ä»¶è°ƒç”¨ä¸€æ¬¡ <code class="language-text">useState()</code>ï¼Œä½ å°†å¤±å»ç”¨ custom hook å¼•å…¥ state èƒ½åŠ›ï¼Œè¿™å°±æ˜¯ custom hooks çš„å…³é”®ã€‚</p>
<h3 id="ç¼ºé™·-2-å‘½åå†²çª"><a href="#%E7%BC%BA%E9%99%B7-2-%E5%91%BD%E5%90%8D%E5%86%B2%E7%AA%81" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #2: å‘½åå†²çª</h3>
<p>ä¸€ä¸ªå¸¸è§çš„å»ºè®®æ˜¯è®©ç»„ä»¶å†… <code class="language-text">useState()</code> æ¥æ”¶ä¸€ä¸ªå”¯ä¸€æ ‡è¯† key å‚æ•°ï¼ˆstring ç­‰ï¼‰åŒºåˆ† state å˜é‡ã€‚</p>
<p>å’Œè¿™ä¸»æ„æœ‰äº›å‡ºå…¥ï¼Œä½†çœ‹èµ·æ¥å¤§è‡´åƒè¿™æ ·ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æˆ‘ä»¬ä¼ å‡ ç§ state key ç»™ useState()</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>surname<span class="token punctuation">,</span> setSurname<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'surname'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> setWidth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre></div>
<p>è¿™è¯•å›¾æ‘†è„±ä¾èµ–é¡ºåºè°ƒç”¨ï¼ˆæ˜¾ç¤º keyï¼‰ï¼Œä½†å¼•å…¥äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ â€”â€” å‘½åå†²çªã€‚</p>
<p>å½“ç„¶é™¤äº†é”™è¯¯ä¹‹å¤–ï¼Œä½ å¯èƒ½æ— æ³•åœ¨åŒä¸€ä¸ªç»„ä»¶è°ƒç”¨ä¸¤æ¬¡ <code class="language-text">useState(&#39;name&#39;)</code>ï¼Œè¿™ç§å¶ç„¶å‘ç”Ÿçš„å¯ä»¥å½’ç»“äºå…¶ä»–ä»»æ„ bugï¼Œä½†æ˜¯ï¼Œå½“ä½ ä½¿ç”¨ä¸€ä¸ª <em>custom hook</em> æ—¶ï¼Œä½ æ€»ä¼šé‡åˆ°æƒ³æ·»åŠ æˆ–ç§»é™¤ state å˜é‡å’Œ effects çš„æƒ…å†µã€‚</p>
<p>è¿™ä¸ªæè®®ä¸­ï¼Œæ¯å½“ä½ åœ¨ custom hook é‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„ state å˜é‡æ—¶ï¼Œå°±æœ‰å¯èƒ½ç ´åä½¿ç”¨å®ƒçš„ä»»ä½•ç»„ä»¶ï¼ˆç›´æ¥æˆ–è€…é—´æ¥ï¼‰ï¼Œå› ä¸º <em>å¯èƒ½å·²ç»æœ‰åŒåçš„å˜é‡</em> ä½äºç»„ä»¶å†…ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰<a href="https://juejin.im/post/5c665e44518825622f12e37c" target="_blank" rel="nofollow noopener noreferrer">åº”å˜è€Œä¼˜</a>çš„ APIï¼Œå½“å‰ä»£ç å¯èƒ½çœ‹èµ·æ¥æ€»æ˜¯ã€Œä¼˜é›…çš„ã€ï¼Œä½†åº”å¯¹éœ€æ±‚å˜åŒ–æ—¶ååˆ†è„†å¼±ï¼Œæˆ‘ä»¬åº”è¯¥ä»<a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html#mixins-cause-name-clashes" target="_blank" rel="nofollow noopener noreferrer">é”™è¯¯</a>ä¸­å¸å–æ•™è®­ã€‚</p>
<p>å®é™…ä¸­ Hooks ææ¡ˆé€šè¿‡ä¾èµ–é¡ºåºè°ƒç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šå³ä½¿ä¸¤ä¸ª Hooks éƒ½ç”¨ <code class="language-text">name</code> state å˜é‡ï¼Œå®ƒä»¬ä¹Ÿä¼šå½¼æ­¤éš”ç¦»ï¼Œæ¯æ¬¡è°ƒç”¨ <code class="language-text">useState()</code> éƒ½ä¼šè·å¾—ç‹¬ç«‹çš„
ã€Œå†…å­˜å•å…ƒã€ã€‚</p>
<p>æˆ‘ä»¬è¿˜æœ‰å…¶ä»–ä¸€äº›æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªç¼ºé™·ï¼Œä½†è¿™äº›æ–¹æ³•ä¹Ÿæœ‰è‡ªèº«çš„ç¼ºé™·ã€‚è®©æˆ‘ä»¬åŠ æ·±æ¢ç´¢è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="ç¼ºé™·-3ï¼šåŒä¸€ä¸ª-hook-æ— æ³•è°ƒç”¨ä¸¤æ¬¡"><a href="#%E7%BC%BA%E9%99%B7-3%EF%BC%9A%E5%90%8C%E4%B8%80%E4%B8%AA-hook-%E6%97%A0%E6%B3%95%E8%B0%83%E7%94%A8%E4%B8%A4%E6%AC%A1" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #3ï¼šåŒä¸€ä¸ª Hook æ— æ³•è°ƒç”¨ä¸¤æ¬¡</h3>
<p>ç»™ <code class="language-text">useState</code> ã€ŒåŠ keyã€çš„å¦ä¸€ç§è¡ç”Ÿææ¡ˆæ˜¯ä½¿ç”¨åƒ Symbol è¿™æ ·çš„ä¸œè¥¿ï¼Œè¿™æ ·å°±ä¸å†²çªäº†å¯¹å§ï¼Ÿ</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">const</span> nameKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> surnameKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> widthKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// æˆ‘ä»¬ä¼ å‡ ç§state keyç»™useState()</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>nameKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>surname<span class="token punctuation">,</span> setSurname<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>surnameKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> setWidth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>widthKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span></code></pre></div>
<p>è¿™ä¸ªææ¡ˆçœ‹ä¸Šå»å¯¹æå–å‡ºæ¥çš„ <code class="language-text">useWindowWidth</code> Hook æœ‰æ•ˆï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token function">useWindowWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token comment">/*********************
 * useWindowWidth.js *
 ********************/</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> widthKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"> </span><span class="gatsby-highlight-code-line"><span class="token keyword">function</span> <span class="token function">useWindowWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>width<span class="token punctuation">,</span> setWidth<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>widthKey<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token comment">// ...</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">return</span> width<span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span></span></code></pre></div>
<p>ä½†å¦‚æœå°è¯•æå–å‡ºæ¥çš„ input handlingï¼Œå®ƒä¼šå¤±è´¥ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> surname <span class="token operator">=</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">name</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">surname</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>    
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/*******************
 * useFormInput.js *
 ******************/</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> valueKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"> </span><span class="gatsby-highlight-code-line"><span class="token keyword">function</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>valueKey<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    value<span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      <span class="token function">setValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token punctuation">}</span></span></code></pre></div>
<p>(æˆ‘æ‰¿è®¤ <code class="language-text">useFormInput()</code> Hook ä¸æ˜¯ç‰¹åˆ«å¥½ç”¨ï¼Œä½†ä½ å¯ä»¥æƒ³è±¡ä¸‹å®ƒå¤„ç†è¯¸å¦‚éªŒè¯å’Œ dirty state æ ‡å¿—ä¹‹ç±»ï¼Œå¦‚ <a href="https://github.com/jaredpalmer/formik" target="_blank" rel="nofollow noopener noreferrer">Formik</a>ã€‚)</p>
<p>ä½ èƒ½å‘ç°è¿™ä¸ªbugå—ï¼Ÿ</p>
<p>æˆ‘ä»¬è°ƒç”¨ <code class="language-text">useFormInput()</code> ä¸¤æ¬¡ï¼Œä½† <code class="language-text">useFormInput()</code> æ€»æ˜¯ç”¨åŒä¸€ä¸ª key è°ƒç”¨ <code class="language-text">useState()</code>ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx">  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>valueKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>surname<span class="token punctuation">,</span> setSurname<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>valueKey<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>æˆ‘ä»¬å†æ¬¡å‘ç”Ÿäº†å†²çªã€‚</p>
<p>å®é™…ä¸­ Hooks ææ¡ˆæ²¡æœ‰è¿™ç§é—®é¢˜ï¼Œå› ä¸º<strong>æ¯æ¬¡ <em>è°ƒç”¨</em> <code class="language-text">useState()</code> ä¼šè·å¾—å•ç‹¬çš„state</strong>ã€‚ä¾èµ–äºå›ºå®šé¡ºåºè°ƒç”¨ä½¿æˆ‘ä»¬å…äºæ‹…å¿ƒå‘½åå†²çªã€‚</p>
<h3 id="ç¼ºé™·-4ï¼šé’»çŸ³é—®é¢˜å¤šå±‚ç»§æ‰¿é—®é¢˜"><a href="#%E7%BC%BA%E9%99%B7-4%EF%BC%9A%E9%92%BB%E7%9F%B3%E9%97%AE%E9%A2%98%E5%A4%9A%E5%B1%82%E7%BB%A7%E6%89%BF%E9%97%AE%E9%A2%98" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #4ï¼šé’»çŸ³é—®é¢˜(å¤šå±‚ç»§æ‰¿é—®é¢˜)</h3>
<p>ä»æŠ€æœ¯ä¸Šæ¥è¯´è¿™ä¸ªå’Œä¸Šä¸€ä¸ªç¼ºé™·ç›¸åŒï¼Œä½†å®ƒçš„è‡­åå€¼å¾—è¯´è¯´ï¼Œç”šè‡³ç»´åŸºç™¾ç§‘éƒ½æœ‰ä»‹ç»ã€‚(æœ‰äº›æ—¶å€™è¿˜è¢«ç§°ä¸ºã€Œè‡´å‘½çš„æ­»äº¡é’»çŸ³ã€ â€”â€” coolï¼)</p>
<p>æˆ‘ä»¬è‡ªå·±çš„ mixin ç³»ç»Ÿå°±<a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html#mixins-cause-name-clashes" target="_blank" rel="nofollow noopener noreferrer">å—åˆ°äº†ä¼¤å®³</a>ã€‚</p>
<p>æ¯”å¦‚<code class="language-text">useWindowWidth()</code> å’Œ <code class="language-text">useNetworkStatus()</code> è¿™ä¸¤ä¸ª custom hooks å¯èƒ½è¦ç”¨åƒ <code class="language-text">useSubscription()</code> è¿™æ ·çš„ custom hookï¼Œå¦‚ä¸‹ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">StatusMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token function">useWindowWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">useNetworkStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">Window width is </span><span class="token punctuation">{</span>width<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token plain-text">You are </span><span class="token punctuation">{</span>isOnline <span class="token operator">?</span> <span class="token string">'online'</span> <span class="token punctuation">:</span> <span class="token string">'offline'</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">function</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span>subscribe<span class="token punctuation">,</span> unsubscribe<span class="token punctuation">,</span> getValue<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">subscribe</span><span class="token punctuation">(</span>handleChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">unsubscribe</span><span class="token punctuation">(</span>handleChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> state<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useWindowWidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span></span><span class="gatsby-highlight-code-line">    handler <span class="token operator">=></span> window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    handler <span class="token operator">=></span> window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> window<span class="token punctuation">.</span>innerWidth</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token keyword">return</span> width<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useNetworkStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> isOnline <span class="token operator">=</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span></span><span class="gatsby-highlight-code-line">    handler <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    handler <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span> handler<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> navigator<span class="token punctuation">.</span>onLine</span><span class="gatsby-highlight-code-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token keyword">return</span> isOnline<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>è¿™æ˜¯ä¸€ä¸ªçœŸå®å¯è¿è¡Œçš„ç¤ºä¾‹ã€‚ <strong>custom hook ä½œè€…å‡†å¤‡æˆ–åœæ­¢ä½¿ç”¨å¦ä¸€ä¸ª custom hook åº”è¯¥æ˜¯è¦å®‰å…¨çš„ï¼Œè€Œä¸å¿…æ‹…å¿ƒå®ƒæ˜¯å¦å·²åœ¨é“¾ä¸­æŸå¤„ã€Œè¢«ç”¨è¿‡äº†ã€</strong>ã€‚</p>
<p>(ä½œä¸ºåä¾‹ï¼Œé—ç•™çš„ React <code class="language-text">createClass()</code> çš„ mixins ä¸å…è®¸ä½ è¿™æ ·åšï¼Œæœ‰æ—¶ä½ ä¼šæœ‰ä¸¤ä¸ª mixinsï¼Œå®ƒä»¬éƒ½æ˜¯ä½ æƒ³è¦çš„ï¼Œä½†ç”±äºæ‰©å±•äº†åŒä¸€ä¸ª ã€Œbaseã€ mixinï¼Œå› æ­¤äº’ä¸å…¼å®¹ã€‚)</p>
<p>è¿™æ˜¯æˆ‘ä»¬çš„ ã€Œé’»çŸ³ã€ï¼šğŸ’</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">       / useWindowWidth()   \                   / useState()  ğŸ”´ Clash
Status                        useSubscription() 
       \ useNetworkStatus() /                   \ useEffect() ğŸ”´ Clash</code></pre></div>
<p>ä¾èµ–äºå›ºå®šçš„é¡ºåºè°ƒç”¨å¾ˆè‡ªç„¶çš„è§£å†³äº†å®ƒï¼š</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">                                                 / useState()  âœ… #1. State
       / useWindowWidth()   -&gt; useSubscription()                    
      /                                          \ useEffect() âœ… #2. Effect
Status                         
      \                                          / useState()  âœ… #3. State
       \ useNetworkStatus() -&gt; useSubscription()
                                                 \ useEffect() âœ… #4. Effect</code></pre></div>
<p>å‡½æ•°è°ƒç”¨ä¸ä¼šæœ‰ã€Œé’»çŸ³ã€é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬ä¼šå½¢æˆæ ‘çŠ¶ç»“æ„ã€‚ğŸ„</p>
<h3 id="ç¼ºé™·-5ï¼šå¤åˆ¶ç²˜è´´çš„ä¸»æ„è¢«æ‰“ä¹±"><a href="#%E7%BC%BA%E9%99%B7-5%EF%BC%9A%E5%A4%8D%E5%88%B6%E7%B2%98%E8%B4%B4%E7%9A%84%E4%B8%BB%E6%84%8F%E8%A2%AB%E6%89%93%E4%B9%B1" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #5ï¼šå¤åˆ¶ç²˜è´´çš„ä¸»æ„è¢«æ‰“ä¹±</h3>
<p>æˆ–è®¸æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥æŸç§å‘½åç©ºé—´æ¥æŒ½æ•‘ç»™ state åŠ ã€Œkeyã€æè®®ï¼Œæœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨é—­åŒ…éš”ç¦» state çš„ keyï¼Œè¿™éœ€è¦ä½ åœ¨ ã€Œå®ä¾‹åŒ–ã€ custom hooksæ—¶ç»™æ¯ä¸ª hook è£¹ä¸Šä¸€å±‚ functionï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token comment">/*******************
 * useFormInput.js *
 ******************/</span>
<span class="token keyword">function</span> <span class="token function">createUseFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token comment">// æ¯æ¬¡å®ä¾‹åŒ–éƒ½å”¯ä¸€</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> valueKey <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  </span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>valueKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      value<span class="token punctuation">,</span>
      <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>è¿™ç§ä½œæ³•éå¸¸ç¹çï¼ŒHooks çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€å°±æ˜¯é¿å…ä½¿ç”¨é«˜é˜¶ç»„ä»¶å’Œ render props çš„æ·±å±‚åµŒå¥—å‡½æ•°ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨ä½¿ç”¨ <em>ä»»ä½•</em> custom hook æ—¶è¿›è¡Œã€Œå®ä¾‹åŒ–ã€ â€”â€” è€Œä¸”åœ¨ç»„ä»¶ä¸»ä½“ä¸­åªèƒ½å•æ¬¡ä½¿ç”¨ç”Ÿäº§çš„å‡½æ•°ï¼Œè¿™æ¯”ç›´æ¥è°ƒç”¨ Hooks éº»çƒ¦å¥½å¤šã€‚</p>
<p>å¦å¤–ï¼Œä½ ä¸å¾—ä¸æ“ä½œä¸¤æ¬¡æ‰èƒ½ä½¿ç»„ä»¶ç”¨ä¸Š custom hookã€‚ä¸€æ¬¡åœ¨æœ€é¡¶å±‚(æˆ–åœ¨ç¼–å†™ custom hook æ—¶çš„å‡½æ•°é‡Œå¤´)ï¼Œè¿˜æœ‰ä¸€æ¬¡æ˜¯æœ€ç»ˆçš„è°ƒç”¨ã€‚è¿™æ„å‘³ç€å³ä½¿ä¸€ä¸ªå¾ˆå°çš„æ”¹åŠ¨ï¼Œä½ ä¹Ÿå¾—åœ¨é¡¶å±‚å£°æ˜å’Œrenderå‡½æ•°é—´æ¥å›è·³è½¬ï¼š</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="gatsby-highlight-code-line"><span class="token keyword">const</span> useNameFormInput <span class="token operator">=</span> <span class="token function">createUseFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line"><span class="token keyword">const</span> useSurnameFormInput <span class="token operator">=</span> <span class="token function">createUseFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">useNameFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> surname <span class="token operator">=</span> <span class="token function">useNameFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ä½ è¿˜éœ€è¦éå¸¸ç²¾ç¡®çš„å‘½åï¼Œæ€»æ˜¯éœ€è¦è€ƒè™‘ã€Œä¸¤å±‚ã€å‘½å â€”â€” åƒ <code class="language-text">createUseFormInput</code> è¿™æ ·çš„å·¥å‚å‡½æ•°å’Œ <code class="language-text">useNameFormInput</code>ã€<code class="language-text">useSurnameFormInput</code>è¿™æ ·çš„å®ä¾‹ Hooksã€‚</p>
<p>å¦‚æœä½ åŒæ—¶è°ƒç”¨ä¸¤æ¬¡ç›¸åŒçš„ custom hook ã€Œå®ä¾‹ã€ï¼Œä½ ä¼šå‘ç”Ÿstateå†²çªã€‚äº‹å®ä¸Šï¼Œä¸Šé¢çš„ä»£ç å°±æ˜¯è¿™ç§é”™è¯¯ â€”â€” å‘ç°äº†å—ï¼Ÿ å®ƒåº”è¯¥ä¸ºï¼š</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">useNameFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> surname <span class="token operator">=</span> <span class="token function">useSurnameFormInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Not useNameFormInput!</span></code></pre></div>
<p>è¿™äº›é—®é¢˜å¹¶éä¸å¯å…‹æœï¼Œä½†æˆ‘è®¤ä¸ºå®ƒä»¬ä¼šæ¯”éµå®ˆ <a href="https://reactjs.org/docs/hooks-rules.html" target="_blank" rel="nofollow noopener noreferrer">Hooksè§„åˆ™</a> çš„é˜»åŠ›å¤§äº›ã€‚</p>
<p>é‡è¦çš„æ˜¯ï¼Œå®ƒä»¬æ‰“ç ´äº†å¤åˆ¶ç²˜è´´çš„å°ç®—ç›˜ã€‚åœ¨æ²¡æœ‰å°è£…å¤–å±‚çš„æƒ…å†µä¸‹è¿™ç§ custom hook ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼Œä½†å®ƒä»¬åªå¯ä»¥è¢«è°ƒç”¨ä¸€æ¬¡(è¿™åœ¨ä½¿ç”¨æ—¶ä¼šäº§ç”Ÿé—®é¢˜)ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå½“ä¸€ä¸ªAPIçœ‹èµ·æ¥å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä¸€æ—¦ä½ æ„è¯†åˆ°åœ¨é“¾çš„æŸä¸ªåœ°æ–¹å‡ºç°äº†å†²çªæ—¶ï¼Œå°±ä¸å¾—ä¸æŠŠæ‰€æœ‰å®šä¹‰å¥½çš„ä¸œè¥¿åŒ…èµ·æ¥äº†ã€‚</p>
<h3 id="ç¼ºé™·-6ï¼šæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ªä»£ç æ£€æŸ¥å·¥å…·"><a href="#%E7%BC%BA%E9%99%B7-6%EF%BC%9A%E6%88%91%E4%BB%AC%E4%BB%8D%E7%84%B6%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5%E5%B7%A5%E5%85%B7" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #6ï¼šæˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ªä»£ç æ£€æŸ¥å·¥å…·</h3>
<p>è¿˜æœ‰å¦å¤–ä¸€ç§ä½¿ç”¨å¯†é’¥stateæ¥é¿å…å†²çªçš„æ–¹æ³•ï¼Œå¦‚æœä½ çŸ¥é“ï¼Œå¯èƒ½ä¼šçœŸçš„å¾ˆç”Ÿæ°”ï¼Œå› ä¸ºæˆ‘ä¸çœ‹å¥½å®ƒï¼ŒæŠ±æ­‰ã€‚</p>
<p>è¿™ä¸ªä¸»æ„å°±æ˜¯æ¯æ¬¡å†™ custom hook æ—¶ <em>ç»„åˆ</em> ä¸€ä¸ªå¯†é’¥ï¼Œå°±åƒè¿™æ ·ï¼š</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> surname <span class="token operator">=</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span><span class="token string">'surname'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token comment">// ...</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>input <span class="token punctuation">{</span><span class="token operator">...</span>name<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>input <span class="token punctuation">{</span><span class="token operator">...</span>surname<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span>    
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="gatsby-highlight-code-line"><span class="token keyword">function</span> <span class="token function">useFormInput</span><span class="token punctuation">(</span>formInputKey<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'useFormInput('</span> <span class="token operator">+</span> formInputKey <span class="token operator">+</span> <span class="token string">').value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">,</span>
    <span class="token function">onChange</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setValue</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å’Œå…¶ä»–æ›¿ä»£æè®®æ¯”ï¼Œæˆ‘æœ€ä¸å–œæ¬¢è¿™ä¸ªï¼Œæˆ‘è§‰å¾—å®ƒæ²¡æœ‰ä»€ä¹ˆä»·å€¼ã€‚</p>
<p>ä¸€ä¸ª Hook ç»è¿‡å¤šæ¬¡è°ƒç”¨æˆ–è€…ä¸å…¶ä»– Hook å†²çªä¹‹åï¼Œä»£ç å¯èƒ½ <em>æ„å¤–äº§å‡º</em> éå”¯ä¸€æˆ–åˆæˆæ— æ•ˆå¯†é’¥è¿›è¡Œä¼ é€’ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœå®ƒæ˜¯åœ¨æŸäº›æ¡ä»¶ä¸‹å‘ç”Ÿçš„(æˆ‘ä»¬ä¼šè¯•å›¾ ã€Œä¿®å¤ã€ å®ƒå¯¹å§ï¼Ÿ)ï¼Œå¯èƒ½åœ¨ä¸€æ®µæ—¶é—´åæ‰å‘ç”Ÿå†²çªã€‚</p>
<p>æˆ‘ä»¬æƒ³æé†’å¤§å®¶ï¼Œè®°ä½æ‰€æœ‰é€šè¿‡å¯†é’¥æ¥æ ‡è®°çš„ custom hooks éƒ½å¾ˆè„†å¼±ï¼Œå®ƒä»¬ä¸ä»…å¢åŠ äº†è¿è¡Œæ—¶çš„å·¥ä½œé‡(åˆ«å¿˜äº†å®ƒä»¬è¦è½¬æˆ <em>å¯†é’¥</em> )ï¼Œè€Œä¸”ä¼šæ¸æ¸å¢å¤§ bundle å¤§å°ã€‚<strong>ä½†å¦‚æœè¯´æˆ‘ä»¬éè¦æé†’ä¸€ä¸ªé—®é¢˜ï¼Œæ˜¯å“ªä¸ªé—®é¢˜å‘¢</strong>ï¼Ÿ</p>
<p>å¦‚æœéè¦åœ¨æ¡ä»¶åˆ¤æ–­é‡Œå£°æ˜ state å’Œ effectsï¼Œè¿™ç§æ–¹æ³•å¯èƒ½æ˜¯æœ‰ä½œç”¨çš„ï¼Œä½†æŒ‰è¿‡å»ç»éªŒæ¥è¯´ï¼Œæˆ‘å‘ç°å®ƒä»¤äººå›°æƒ‘ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä¸è®°å¾—æœ‰äººä¼šåœ¨æ¡ä»¶åˆ¤æ–­é‡Œå®šä¹‰<code class="language-text">this.state</code>æˆ–è€…<code class="language-text">componentMount</code>çš„ã€‚</p>
<p>è¿™æ®µä»£ç åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿ</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>isActive<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">    <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>p onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å½“ <code class="language-text">props.isActive</code> ä¸º <code class="language-text">false</code> æ—¶ <code class="language-text">count</code> æ˜¯å¦è¢«ä¿ç•™ï¼Ÿæˆ–è€…ç”±äº <code class="language-text">useState(&#39;count&#39;)</code> æ²¡æœ‰è¢«è°ƒç”¨è€Œé‡ç½® <code class="language-text">count</code>ï¼Ÿ</p>
<p>å¦‚æœæ¡ä»¶ä¸ºä¿ç•™ stateï¼Œeffect åˆä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// âš ï¸ è¿™ä¸æ˜¯ React Hooks API</span>
<span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>isActive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'count'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="gatsby-highlight-code-line">      <span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>c <span class="token operator">=></span> c <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">      <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">clearInterval</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>p onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setCount</span><span class="token punctuation">(</span>count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token punctuation">{</span>count<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>æ— ç–‘å®ƒä¸ä¼šåœ¨ <code class="language-text">props.isActive</code> ç¬¬ä¸€æ¬¡æ˜¯ <code class="language-text">true</code> <em>ä¹‹å‰</em> è¿è¡Œï¼Œä½†ä¸€æ—¦å˜æˆ <code class="language-text">true</code>ï¼Œå®ƒä¼šåœæ­¢è¿è¡Œå—ï¼Ÿå½“ <code class="language-text">props.isActive</code> è½¬å˜ä¸º <code class="language-text">false</code> æ—¶ interval ä¼šé‡ç½®å—ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œeffect ä¸ state(æˆ‘ä»¬è¯´ä¸é‡ç½®æ—¶) çš„è¡Œä¸ºä¸åŒä»¤äººå›°æƒ‘ã€‚å¦‚æœ effect ç»§ç»­è¿è¡Œï¼Œé‚£ä¹ˆ effect å¤–å±‚çš„ <code class="language-text">if</code> ä¸å†æ§åˆ¶ effectï¼Œè¿™ä¹Ÿä»¤äººæ„Ÿåˆ°å›°æƒ‘ï¼Œæˆ‘ä»¬ä¸æ˜¯è¯´æˆ‘ä»¬æƒ³è¦åŸºäºæ¡ä»¶æ§åˆ¶çš„ effects å—ï¼Ÿ  </p>
<p>å¦‚æœåœ¨æ¸²æŸ“æœŸé—´æˆ‘ä»¬æ²¡æœ‰ã€Œä½¿ç”¨ã€ state ä½† å®ƒå´è¢«é‡ç½®ï¼Œå¦‚æœæœ‰å¤šä¸ª <code class="language-text">if</code> åˆ†æ”¯åŒ…å« <code class="language-text">useState(&#39;count&#39;)</code> ä½†åªæœ‰å…¶ä¸­ä¸€ä¸ªä¼šåœ¨ç»™å®šæ—¶é—´é‡Œè¿è¡Œï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¿™æ˜¯æœ‰æ•ˆçš„ä»£ç å—ï¼Ÿå¦‚æœæˆ‘ä»¬çš„æ ¸å¿ƒæ€æƒ³æ˜¯ ã€Œä»¥å¯†é’¥åˆ†å¸ƒã€ï¼Œé‚£ä¸ºä»€ä¹ˆè¦ ã€Œä¸¢å¼ƒã€ å®ƒï¼Ÿå¼€å‘äººå‘˜æ˜¯å¦å¸Œæœ›åœ¨è¿™ä¹‹åä»ç»„ä»¶ä¸­æå‰ <code class="language-text">return</code> ä»¥é‡ç½®æ‰€æœ‰ state å‘¢ï¼Ÿ å…¶å®å¦‚æœæˆ‘ä»¬çœŸçš„éœ€è¦é‡ç½®stateï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æå–ç»„ä»¶ä½¿å…¶æ˜ç¡®ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">Counter</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>isActive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ¸…æ™°åœ°çŸ¥é“å®ƒæœ‰è‡ªå·±çš„ state</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TickingCounter</span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>æ— è®ºå¦‚ä½•è¿™å¯èƒ½æˆä¸ºæ˜¯è§£å†³è¿™äº›å›°æƒ‘é—®é¢˜çš„ã€Œæœ€ä½³å®è·µã€ï¼Œæ‰€ä»¥ä¸ç®¡ä½ é€‰æ‹©å“ªç§æ–¹å¼å»è§£é‡Šï¼Œæˆ‘è§‰å¾—æ¡ä»¶é‡Œ <em>å£°æ˜</em> state å’Œ effect çš„è¯­ä¹‰æ€æ ·éƒ½å¾ˆæ€ªå¼‚ï¼Œä½ å¯èƒ½ä¼šä¸çŸ¥ä¸è§‰çš„æ„Ÿå—åˆ°ã€‚</p>
<p>å¦‚æœè¿˜è¦æé†’çš„æ˜¯ â€”â€” æ­£ç¡®åœ°ç»„åˆå¯†é’¥çš„éœ€æ±‚ä¼šå˜æˆã€Œè´Ÿæ‹…ã€ï¼Œå®ƒå¹¶æ²¡æœ‰ç»™æˆ‘ä»¬å¸¦æ¥ä»»ä½•æƒ³è¦çš„ã€‚ä½†æ˜¯ï¼Œæ”¾å¼ƒè¿™ä¸ªéœ€æ±‚(å¹¶å›åˆ°æœ€åˆçš„ææ¡ˆ)ç¡®å®ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸€äº›ä¸œè¥¿ï¼Œå®ƒä½¿ç»„ä»¶ä»£ç èƒ½å¤Ÿå®‰å…¨åœ°å¤åˆ¶ç²˜è´´åˆ°ä¸€ä¸ª custom hook ä¸­ï¼Œä¸”ä¸éœ€è¦å‘½åç©ºé—´ï¼Œå‡å° bundle å¤§å°åŠè½»å¾®çš„æ•ˆç‡æå‡(ä¸éœ€è¦MapæŸ¥æ‰¾)ã€‚</p>
<p>æ…¢æ…¢ç†è§£ã€‚</p>
<h3 id="ç¼ºé™·-7ï¼šhooks-ä¹‹é—´æ— æ³•ä¼ å€¼"><a href="#%E7%BC%BA%E9%99%B7-7%EF%BC%9Ahooks-%E4%B9%8B%E9%97%B4%E6%97%A0%E6%B3%95%E4%BC%A0%E5%80%BC" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #7ï¼šHooks ä¹‹é—´æ— æ³•ä¼ å€¼</h3>
<p>Hooks æœ‰ä¸ªæœ€å¥½çš„åŠŸèƒ½å°±æ˜¯å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´ä¼ å€¼ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªé€‰æ‹©ä¿¡æ¯æ”¶ä»¶äººçš„æ¨¡æ‹Ÿç¤ºä¾‹ï¼Œå®ƒæ˜¾ç¤ºäº†å½“å‰é€‰æ‹©çš„å¥½å‹æ˜¯å¦åœ¨çº¿ï¼š</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> friendList <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'Phoebe'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'Rachel'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">'Ross'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">ChatRecipientPicker</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>recipientID<span class="token punctuation">,</span> setRecipientID<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> isRecipientOnline <span class="token operator">=</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span>recipientID<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Circle</span> <span class="token attr-name">color</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isRecipientOnline <span class="token operator">?</span> <span class="token string">'green'</span> <span class="token punctuation">:</span> <span class="token string">'red'</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span>
        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>recipientID<span class="token punctuation">}</span></span>
        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>e <span class="token operator">=></span> <span class="token function">setRecipientID</span><span class="token punctuation">(</span><span class="token function">Number</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
      <span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">        </span><span class="token punctuation">{</span>friendList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>friend <span class="token operator">=></span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>friend<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">            </span><span class="token punctuation">{</span>friend<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="token plain-text">          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span><span class="token plain-text"></span>
<span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>isOnline<span class="token punctuation">,</span> setIsOnline<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token function-variable function">handleStatusChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>status<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setIsOnline</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    ChatAPI<span class="token punctuation">.</span><span class="token function">subscribeToFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      ChatAPI<span class="token punctuation">.</span><span class="token function">unsubscribeFromFriendStatus</span><span class="token punctuation">(</span>friendID<span class="token punctuation">,</span> handleStatusChange<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> isOnline<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>å½“æ”¹å˜æ”¶ä»¶äººæ—¶ï¼Œ<code class="language-text">useFriendStatus</code> Hook å°±ä¼šé€€è®¢ä¸Šä¸€ä¸ªå¥½å‹çš„çŠ¶æ€ï¼Œè®¢é˜…æ¥ä¸‹æ¥çš„è¿™ä¸ªã€‚</p>
<p>è¿™æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°† <code class="language-text">useState()</code> Hook è¿”å›çš„å€¼ä¼ ç»™ <code class="language-text">useFriendStatus()</code> Hookï¼š</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token keyword">const</span> <span class="token punctuation">[</span>recipientID<span class="token punctuation">,</span> setRecipientID<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="gatsby-highlight-code-line">  <span class="token keyword">const</span> isRecipientOnline <span class="token operator">=</span> <span class="token function">useFriendStatus</span><span class="token punctuation">(</span>recipientID<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre></div>
<p>Hooksä¹‹é—´ä¼ å€¼éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼š<a href="https://medium.com/@drcmda/hooks-in-react-spring-a-tutorial-c6c436ad7ee4" target="_blank" rel="nofollow noopener noreferrer">React Spring</a>å¯ä»¥åˆ›å»ºä¸€ä¸ªå°¾éšåŠ¨ç”»ï¼Œå…¶ä¸­å¤šä¸ªå€¼å½¼æ­¤ã€Œè·Ÿéšã€ï¼š</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> pos1 <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">set</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSpring</span><span class="token punctuation">(</span><span class="token punctuation">{</span> pos1<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> config<span class="token punctuation">:</span> fast <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> pos2 <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSpring</span><span class="token punctuation">(</span><span class="token punctuation">{</span> pos2<span class="token punctuation">:</span> pos1<span class="token punctuation">,</span> config<span class="token punctuation">:</span> slow <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> pos3 <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSpring</span><span class="token punctuation">(</span><span class="token punctuation">{</span> pos3<span class="token punctuation">:</span> pos2<span class="token punctuation">,</span> config<span class="token punctuation">:</span> slow <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>(è¿™æ˜¯ <a href="https://codesandbox.io/s/ppxnl191zx" target="_blank" rel="nofollow noopener noreferrer">demo</a>ã€‚)</p>
<p>åœ¨Hookåˆå§‹åŒ–æ—¶æ·»åŠ é»˜è®¤å‚æ•°æˆ–è€…å°†Hookå†™åœ¨è£…é¥°å™¨è¡¨å•ä¸­çš„æè®®ï¼Œå¾ˆéš¾å®ç°è¿™ç§æƒ…å†µçš„é€»è¾‘ã€‚</p>
<p>å¦‚æœä¸åœ¨å‡½æ•°ä½“å†…è°ƒç”¨ Hooksï¼Œå°±ä¸å¯ä»¥è½»æ¾åœ°åœ¨å®ƒä»¬ä¹‹é—´ä¼ å€¼äº†ã€‚ä½ å¯ä»¥æ”¹å˜è¿™äº›å€¼ç»“æ„ï¼Œè®©å®ƒä»¬ä¸éœ€è¦åœ¨å¤šå±‚ç»„ä»¶ä¹‹é—´ä¼ é€’ï¼Œä¹Ÿå¯ä»¥ç”¨ <code class="language-text">useMemo</code> æ¥å­˜å‚¨è®¡ç®—ç»“æœã€‚ä½†ä½ ä¹Ÿæ— æ³•åœ¨ effects ä¸­å¼•ç”¨è¿™äº›å€¼ï¼Œå› ä¸ºå®ƒä»¬æ— æ³•åœ¨é—­åŒ…ä¸­è¢«è·å–åˆ°ã€‚æœ‰äº›æ–¹æ³•å¯ä»¥é€šè¿‡æŸäº›çº¦å®šæ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œä½†å®ƒä»¬éœ€è¦ä½ åœ¨å¿ƒé‡Œã€Œæ ¸ç®—ã€è¾“å…¥å’Œè¾“å‡ºï¼Œè¿™è¿èƒŒäº† React ç›´æ¥äº†å½“çš„é£æ ¼ã€‚</p>
<p>åœ¨ Hooks ä¹‹é—´ä¼ å€¼æ˜¯æˆ‘ä»¬ææ¡ˆçš„æ ¸å¿ƒï¼ŒRender props æ¨¡å¼åœ¨æ²¡æœ‰ Hooks æ—¶æ˜¯ä½ æœ€å…ˆèƒ½æƒ³åˆ°çš„ï¼Œä½†åƒ <a href="https://ui.reach.tech/component-component" target="_blank" rel="nofollow noopener noreferrer">Component Component</a> è¿™æ ·çš„åº“ï¼Œæ˜¯æ— æ³•é€‚ç”¨äºä½ é‡åˆ°çš„æ‰€æœ‰åœºæ™¯çš„ï¼Œå®ƒç”±äºã€Œé”™è¯¯çš„å±‚æ¬¡ç»“æ„ã€å­˜åœ¨å¤§é‡çš„è¯­æ³•å¹²æ‰°ã€‚Hooks ç”¨æ‰å¹³åŒ–å±‚æ¬¡ç»“æ„æ¥å®ç°ä¼ å€¼ â€”â€” ä¸”å‡½æ•°è°ƒç”¨æ˜¯æœ€ç®€å•çš„ä¼ å€¼æ–¹å¼ã€‚</p>
<h3 id="ç¼ºé™·-8ï¼šæ­¥éª¤ç¹ç"><a href="#%E7%BC%BA%E9%99%B7-8%EF%BC%9A%E6%AD%A5%E9%AA%A4%E7%B9%81%E7%90%90" aria-hidden class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ç¼ºé™· #8ï¼šæ­¥éª¤ç¹ç</h3>
<p>æœ‰è®¸å¤šæè®®å¤„äºè¿™ç§èŒƒç•´é‡Œã€‚ä»–ä»¬å°½å¯èƒ½çš„æƒ³è®©Reactæ‘†è„±å¯¹ Hooks çš„ä¾èµ–æ„Ÿï¼Œå¤§å¤šæ•°æ–¹æ³•æ˜¯è¿™ä¹ˆåšçš„ï¼šè®© <code class="language-text">this</code> æ‹¥æœ‰å†…ç½® Hooksï¼Œä½¿å®ƒä»¬å˜æˆé¢å¤–çš„å‚æ•°åœ¨Reactä¸­æ— å¤„ä¸åœ¨ï¼Œç­‰ç­‰ç­‰ã€‚</p>
<p>æˆ‘è§‰å¾— <a href="https://github.com/reactjs/rfcs/pull/68#issuecomment-439314884" target="_blank" rel="nofollow noopener noreferrer">Sebastiançš„å›ç­”</a> æ¯”æˆ‘çš„æè¿°ï¼Œæ›´èƒ½è¯´æœè¿™ç§æ–¹å¼ï¼Œæˆ‘å»ºè®®ä½ å»äº†è§£ä¸‹ã€Œæ³¨å…¥æ¨¡å‹ã€ã€‚</p>
<p>æˆ‘åªæƒ³è¯´è¿™å’Œç¨‹åºå‘˜å€¾å‘äºç”¨ <code class="language-text">try</code>/<code class="language-text">catch</code> æ•è·æ–¹æ³•ä¸­çš„é”™è¯¯ä»£ç æ˜¯ä¸€æ ·çš„é“ç†ï¼ŒåŒæ ·å¯¹æ¯” AMDç”±æˆ‘ä»¬è‡ªå·±ä¼ å…¥ <code class="language-text">require</code> çš„ã€Œæ˜¾ç¤ºã€å£°æ˜ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢ <code class="language-text">import</code>(æˆ–è€… CommonJS <code class="language-text">require</code>) çš„ ESæ¨¡å—ã€‚</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// æœ‰è°æƒ³å¿µ AMDï¼Ÿ</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'require'</span><span class="token punctuation">,</span> <span class="token string">'dependency1'</span><span class="token punctuation">,</span> <span class="token string">'dependency2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>require<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> dependency1 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dependency1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">var</span> dependency2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'dependency2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>æ˜¯çš„ï¼ŒAMD å¯èƒ½æ›´ã€Œè¯šå®ã€ çš„é™ˆè¿°äº†åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­æ¨¡å—ä¸æ˜¯åŒæ­¥åŠ è½½çš„ï¼Œä½†å½“ä½ çŸ¥é“äº†è¿™ä¸ªåï¼Œå†™ <code class="language-text">define</code>ä¸‰æ˜æ²» å°±å˜æˆåšæ— ç”¨åŠŸäº†ã€‚</p>
<p><code class="language-text">try</code>/<code class="language-text">catch</code>ã€<code class="language-text">require</code>å’Œ React Context APIéƒ½æ˜¯æˆ‘ä»¬æ›´å–œæ¬¢ã€Œç¯å¢ƒã€å¼ä½“éªŒï¼Œå¤šäºç›´æ¥å£°æ˜ä½¿ç”¨çš„çœŸå®ä¾‹å­(å³ä½¿é€šå¸¸æˆ‘ä»¬æ›´å–œæ¬¢ç›´çˆ½é£æ ¼)ï¼Œæˆ‘è§‰å¾— Hooks ä¹Ÿå±äºè¿™ç§ã€‚</p>
<p>è¿™ç±»ä¼¼äºå½“æˆ‘ä»¬å£°æ˜ç»„ä»¶æ—¶ï¼Œå°±åƒä» <code class="language-text">React</code> æŠ“ä¸ª <code class="language-text">Component</code> è¿‡æ¥ã€‚å¦‚æœæˆ‘ä»¬ç”¨å·¥å‚çš„æ–¹å¼å¯¼å‡ºæ¯ä¸ªç»„ä»¶ï¼Œå¯èƒ½æˆ‘ä»¬çš„ä»£ç ä¼šæ›´è§£è€¦ï¼š</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">createModal</span><span class="token punctuation">(</span>React<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">Modal</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>ä½†åœ¨å®é™…ä¸­ï¼Œè¿™æœ€åä¼šå˜å¾—å¤šæ­¤ä¸€ä¸¾è€Œä»¤äººåŒçƒ¦ã€‚å½“æˆ‘ä»¬çœŸçš„æƒ³ä»¥æŸç§æ–¹å¼æŠ“Reactæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨æ¨¡å—ç³»ç»Ÿå±‚é¢ä¸Šå®ç°ã€‚</p></div><footer><p><a href="https://mobile.twitter.com/search?q=https%3A%2F%2Foverreacted.io%2Fwhy-do-hooks-rely-on-call-order%2F" target="_blank" rel="noopener noreferrer">Discuss on Twitter</a> â€¢ <a href="https://github.com/gaearon/overreacted.io/edit/master/src/pages/why-do-hooks-rely-on-call-order/index.zh-hans.md" target="_blank" rel="noopener noreferrer">Edit on GitHub</a></p></footer></article></main><aside><div style="margin:90px 0 40px 0;font-family:system-ui, -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;,
    &quot;Roboto&quot;, &quot;Oxygen&quot;, &quot;Ubuntu&quot;, &quot;Cantarell&quot;, &quot;Fira Sans&quot;,
    &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif"><form action="https://app.convertkit.com/forms/812047/subscriptions" class="seva-form formkit-form" method="post" min-width="400 500 600 700 800" style="background-color:rgb(255, 255, 255);border-radius:6px"><div data-style="full"><div data-element="column" class="formkit-column" style="background-color:rgb(249, 250, 251)"><h1 class="formkit-header" data-element="header" style="color:rgb(77, 77, 77);font-size:20px;font-weight:700">Join the Newsletter</h1><div data-element="subheader" class="formkit-subheader" style="color:rgb(104, 104, 104)"><p>Subscribe to get my latest content by email.</p></div><div class="formkit-image"><svg xmlns="http://www.w3.org/2000/svg" width="46" height="46" viewBox="0 0 46 46" style="max-width:100%"><g fill="none" fill-rule="evenodd"><path fill="#DD92AB" d="M23,36 C22.813,36 22.627,35.948 22.463,35.844 L0.463,21.844 C0.159,21.651 -0.017,21.308 0.001,20.948 C0.02,20.589 0.23,20.266 0.553,20.105 L23,6 L45.447,20.105 C45.769,20.266 45.98,20.588 45.999,20.948 C46.018,21.308 45.841,21.65 45.537,21.844 L23.537,35.844 C23.373,35.948 23.187,36 23,36 Z"></path><path fill="#FFF" d="M38,37 L8,37 L8,1 C8,0.448 8.448,0 9,0 L37,0 C37.552,0 38,0.448 38,1 L38,37 Z"></path><path fill="#FFA7C4" d="M45,46 C44.916,46 44.831,45.989 44.748,45.968 L21.748,39.968 L22,33 L46,21 L46,45 C46,45.31 45.856,45.602 45.611,45.792 C45.435,45.928 45.219,46 45,46 Z"></path><path fill="#FFC3D7" d="M45,46 L1,46 C0.447,46 0,45.552 0,45 L0,21 L45.479,44.122 C45.88,44.341 46.083,44.804 45.969,45.247 C45.856,45.69 45.457,46 45,46 Z"></path><path fill="#FFA7C4" d="M19 20.414L14.293 15.707C13.902 15.316 13.902 14.684 14.293 14.293L19 9.586 20.414 11 16.414 15 20.414 19 19 20.414zM27 20.414L25.586 19 29.586 15 25.586 11 27 9.586 31.707 14.293C32.098 14.684 32.098 15.316 31.707 15.707L27 20.414z"></path></g></svg></div></div><div data-element="column" class="formkit-column"><ul class="formkit-alert formkit-alert-error" data-element="errors" data-group="alert"></ul><div data-element="fields" class="seva-fields formkit-fields"><div class="formkit-field"><input type="text" class="formkit-input" aria-label="Your first name" name="fields[first_name]" placeholder="Your first name" style="border-color:rgb(227, 227, 227);border-radius:4px;color:rgb(0, 0, 0);font-weight:400"/></div><div class="formkit-field"><input type="email" class="formkit-input" name="email_address" aria-label="Your email address" placeholder="Your email address" style="border-color:rgb(227, 227, 227);border-radius:4px;color:rgb(0, 0, 0);font-weight:400"/></div><button data-element="submit" class="formkit-submit formkit-submit" style="background-color:hsl(340, 63%, 55%);border-radius:24px;color:white;font-weight:700"><div class="formkit-spinner"></div><span>Subscribe</span></button></div><div data-element="guarantee" class="formkit-guarantee" style="color:rgb(77, 77, 77);font-size:13px;font-weight:400"><p>I wonâ€™t send you spam.</p><p>Unsubscribe at <em>any</em> time.</p></div></div></div></form></div><h3 style="font-family:Montserrat, sans-serif;margin-top:0.4375rem"><a style="box-shadow:none;text-decoration:none;color:var(--pink)" href="/">Overreacted</a></h3><div style="display:flex;margin-bottom:3.5rem"><img src="/static/profile-pic-69c77131fd248a7aaaf26fab021f469f.png" alt="Yusuf Unlu" style="margin-right:0.875rem;margin-bottom:0;height:3.5rem;border-radius:50%"/><p style="max-width:310px">Personal blog by <a href="https://mobile.twitter.com/yufusunlu">Yusuf Unlu</a>.<!-- --> <!-- -->IÂ explain with words and code.</p></div><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li></li><li></li></ul></nav></aside></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-130227707-1', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"zh-hans-why-do-hooks-rely-on-call-order-e3e","path":"/zh-hans/why-do-hooks-rely-on-call-order/"};window.dataPath="225/path---zh-hans-why-do-hooks-rely-on-call-order-e-3-e-fa3-Z0j3dSZmZX3xUyUNXfYKoEZsr8";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-83825dcbe188439d174e.js"],"component---src-templates-blog-index-js":["/component---src-templates-blog-index-js-1d061c91bf8b4d1ed13d.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js.f3aea2f29a9b96501823.css","/component---src-templates-blog-post-js-5ff9d93420b5b2cefece.js"],"component---src-pages-404-js":["/component---src-pages-404-js.e9c5c3b80c5e9b8c6fa0.css","/component---src-pages-404-js-6115a896c1bd484b3973.js"],"component---src-pages-confirm-js":["/component---src-pages-confirm-js.e9c5c3b80c5e9b8c6fa0.css","/component---src-pages-confirm-js-e5c8bcda280c240e1d6e.js"],"component---src-pages-thanks-js":["/component---src-pages-thanks-js.e9c5c3b80c5e9b8c6fa0.css","/component---src-pages-thanks-js-bd098f6660863fbb8af2.js"],"pages-manifest":["/pages-manifest-f3e11a74ebf6959e04be.js"]};/*]]>*/</script><script src="/webpack-runtime-dea655677e505366ecd7.js" async=""></script><script src="/1-1b550cd61a5e170131aa.js" async=""></script><script src="/2-31a6021f1637c5720eda.js" async=""></script><script src="/0-b197e8c6c7ff26484233.js" async=""></script><script src="/app-83825dcbe188439d174e.js" async=""></script><script src="/component---src-templates-blog-post-js-5ff9d93420b5b2cefece.js" async=""></script></body></html>